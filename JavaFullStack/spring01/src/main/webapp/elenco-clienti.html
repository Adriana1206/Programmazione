<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elenco clienti</title>
    <script src="js/net-functions.js"></script>
    <script src="js/dom-functions.js"></script>
    <style>
        /*CSS per "dipingere" la table */

        table, tr, th, td{
            border: 1px solid black;
            border-collapse: collapse;;
        }
    </style>
</head>
<body>
    <h1>Elenco clienti</h1>

    <div id="segnaposto"></div>

    <script>
        "use strict"
        const intestazioni = ["id","nome","cognome","email","indirizzo","citt√†","provincia","cap"];
        //acquisire il segnaposto
        const segnaposto = document.getElementById("segnaposto");
        console.log(segnaposto);

        //creare una table e piazzarla nel segnaposto
        const tabella = document.createElement("table");

        //la piazzo nel segnaposto
        segnaposto.appendChild(tabella);

        //creare una tr
        let tr = document.createElement("tr");
        //appenderla alla table
        tabella.appendChild(tr);

        //per ogni elemento dell'array creo una th
        for(let intestazione of intestazioni){
            const th = document.createElement("th");

            //creo il payload con l'intestazione
            const textNode = document.createTextNode(intestazione);

            //aggiungo l'intestazione alla th
            th.appendChild(textNode);

            //appendo la th alla row
            tr.appendChild(th);
        }

        const url = "http://localhost:8080/clienti";

        

        

        getJson(url, createTableBody);
        function createTableBody(clienti) {
             console.log(clienti);
            for(const cliente of clienti) {
                const tr = createAndAppendElement("tr", tabella);

                //ID
                let td = createAndAppendElement("td", tr);
                let link = createAndAppendElement("a",td);
                link.href = "cliente.html?func=display&id="+cliente.idCliente;
                createAndAppendTextNode(cliente.idCliente, link);
                
                //NOME
                td = createAndAppendElement("td", tr);
                //link = createAndAppendElement("a",td);
                //link.href = "cliente.html?id="+cliente.nome;
                createAndAppendTextNode(cliente.nome, td);
 
                //COGNOME
                td = createAndAppendElement("td", tr);
                //link = createAndAppendElement("a",td);
                //link.href = "cliente.html?id="+cliente.cognome;
                createAndAppendTextNode(cliente.cognome, td);
 
                //EMAIL
                td = createAndAppendElement("td", tr);
                //link = createAndAppendElement("a",td);
                //link.href = "cliente.html?id="+cliente.email;
                createAndAppendTextNode(cliente.email, td);

                //INDIRIZZO
                td = createAndAppendElement("td", tr);
                //link = createAndAppendElement("a",td);
                //link.href = "cliente.html?id="+cliente.citta;
                createAndAppendTextNode(cliente.indirizzo, td);
 
                //CITTA
                td = createAndAppendElement("td", tr);
                //link = createAndAppendElement("a",td);
                //link.href = "cliente.html?id="+cliente.citta;
                createAndAppendTextNode(cliente.citta, td);

                

                //PROVINCIA
                td = createAndAppendElement("td", tr);
                //link = createAndAppendElement("a",td);
                //link.href = "cliente.html?id="+cliente.provincia;
                createAndAppendTextNode(cliente.provincia, td);

                //CAP
                td = createAndAppendElement("td", tr);
                //link = createAndAppendElement("a",td);
                //link.href = "cliente.html?id="+cliente.cap;
                createAndAppendTextNode(cliente.cap, td);

                
                //DELETE ICON
                td = createAndAppendElement("td", tr);
                link = createAndAppendElement("a", td);
                link.href = "cliente.html?func=delete&id="+cliente.idCliente;
                let img = createAndAppendElement("img", link);
                img.src="images/icons8-rimuovere-24.png";
 
                }

               
                
            }
        /****************** PRIMA VERSIONE *************************/
        /*getJson(url, createTableBody);

        function createTableBody(clienti) {
             console.log(clienti);
            for(const cliente of clienti) {
                const tr = document.createElement("tr");

                //creare l'elemento
                //appendere l'elemento
                //rendere disponibile l'elemento per l'elaborazione
 
                //ID
                let td = document.createElement("td");
                let textNode = document.createTextNode(cliente.idCliente);
                td.appendChild(textNode);
                tr.appendChild(td);
                
                //NOME
                td = document.createElement("td");
                textNode = document.createTextNode(cliente.nome);
                td.appendChild(textNode);
                tr.appendChild(td);  
 
 
                //COGNOME
                td = document.createElement("td");
                textNode = document.createTextNode(cliente.cognome);
                td.appendChild(textNode);
                tr.appendChild(td);
               

                //EMAIL
                td = document.createElement("td");
                textNode = document.createTextNode(cliente.email);
                td.appendChild(textNode);
                tr.appendChild(td);
 

                //INDIRIZZO
                td = document.createElement("td");
                textNode = document.createTextNode(cliente.indirizzo);
                td.appendChild(textNode);
                tr.appendChild(td);

                //CITTA'
                td = document.createElement("td");
                textNode = document.createTextNode(cliente.citta);
                td.appendChild(textNode);
                tr.appendChild(td);

                //PROVINCIA
                td = document.createElement("td");
                textNode = document.createTextNode(cliente.provincia);
                td.appendChild(textNode);
                tr.appendChild(td);

                //CAP
                td = document.createElement("td");
                textNode = document.createTextNode(cliente.cap);
                td.appendChild(textNode);
                tr.appendChild(td);

 
                tabella.appendChild(tr);
            }*/
             /****************** PRIMA VERSIONE *************************/
        
    </script>
</body>
</html>